<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Client Script Manager</title>
    
    <!-- 1. ÂºïÂÖ• Tailwind CSS (Ê®£Âºè) -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- 2. Ë®≠ÂÆö React Âíå Firebase ÁöÑÂü∑Ë°åÁí∞Â¢É -->
    <script type="importmap">
    {
      "imports": {
        "react": "https://esm.sh/react@18.2.0",
        "react-dom/client": "https://esm.sh/react-dom@18.2.0/client",
        "lucide-react": "https://esm.sh/lucide-react@0.292.0",
        "firebase/app": "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js",
        "firebase/auth": "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js",
        "firebase/firestore": "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js"
      }
    }
    </script>
    
    <!-- Ëß£Ê±∫‰∏≠Êñá‰∫ÇÁ¢ºËàáÂ≠óÂûã -->
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&display=swap');
        body { font-family: 'Noto Sans TC', sans-serif; }
        @media print {
            @page { size: A4; margin: 10mm; }
            body * { visibility: hidden; }
            .print-container, .print-container * { visibility: visible; }
            .print-container { position: absolute; left: 0; top: 0; width: 100%; }
            nav, button, .no-print { display: none !important; }
        }
        .animate-fadeIn { animation: fadeIn 0.4s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body class="bg-slate-50 text-gray-800">
    <div id="root"></div>

    <script type="module">
        import React, { useState, useEffect, useMemo, useRef } from 'react';
        import { createRoot } from 'react-dom/client';
        import { FileText, Database, ArrowRight, Printer, Save, X, Plus, Trash2, Download, AlertCircle, Loader2, Users, User, ExternalLink, Tag, Copy, Briefcase, Search, Filter, Settings, PlusCircle, MinusCircle, Upload, Check, Info, FileSpreadsheet, AlertTriangle } from 'lucide-react';
        import { initializeApp } from 'firebase/app';
        import { getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged } from 'firebase/auth';
        import { getFirestore, collection, addDoc, updateDoc, deleteDoc, doc, setDoc, getDoc, onSnapshot, serverTimestamp } from 'firebase/firestore';

        // --- Firebase Ë®≠ÂÆöÂçÄÂ°ä ---
        let firebaseConfig;
        let appId = 'client-script-manager-public'; 

        if (typeof __firebase_config !== 'undefined') {
            firebaseConfig = JSON.parse(__firebase_config);
            if (typeof __app_id !== 'undefined') appId = __app_id;
        } else {
            // ÈÉ®ÁΩ≤Ë®≠ÂÆö
            firebaseConfig = {
              apiKey: "AIzaSyC4xkXkRZBVat3qg7tMJLvAKsLelcHGku8",
              authDomain: "everyvideo-d89cb.firebaseapp.com",
              projectId: "everyvideo-d89cb",
              storageBucket: "everyvideo-d89cb.firebasestorage.app",
              messagingSenderId: "435577367444",
              appId: "1:435577367444:web:5b94cea86c952b9dfa7d81",
              measurementId: "G-LWRPKH6XLY"
            };
        }

        // Initialize Firebase with Error Handling
        let app, auth, db;
        try {
            app = initializeApp(firebaseConfig);
            auth = getAuth(app);
            db = getFirestore(app);
        } catch (error) {
            console.error("Firebase ÂàùÂßãÂåñÂ§±Êïó:", error);
            document.body.innerHTML = `<div style="padding:20px; color:red;"><h3>Firebase ÂàùÂßãÂåñÂ§±Êïó</h3><p>${error.message}</p></div>`;
        }

        const DEFAULT_OPTIONS = {
            styles: ["Áü•Ë≠òÊïôÂ≠∏", "ÊÉÖÂ¢ÉÂäá", "ÈñãÁÆ±ÂØ¶Ê∏¨", "Êé°Ë®™/Â∞çË´á", "VlogË®òÈåÑ"],
            products: ["ÊüìÈ´Æ", "ÁáôÈ´Æ", "Ë≠∑È´Æ", "È†≠ÁöÆSPA", "Â±ÖÂÆ∂Ê¥óË≠∑"],
            targets: ["‰∏äÁè≠Êóè", "Â≠∏Áîü", "ÂÆ∂Â∫≠‰∏ªÂ©¶", "È´òÊ∂àË≤ªÊóèÁæ§", "ÊΩÆÊµÅ‰∫∫Â£´"]
        };

        // ... (CSV Parser and other helpers remain the same) ...
        const parseCSVFile = (text) => {
            const rows = [];
            let currentRow = [];
            let currentCell = '';
            let insideQuotes = false;
            const normalizedText = text.replace(/\r\n/g, '\n').replace(/\r/g, '\n');
            for (let i = 0; i < normalizedText.length; i++) {
                const char = normalizedText[i];
                const nextChar = normalizedText[i + 1];
                if (char === '"') {
                    if (insideQuotes && nextChar === '"') { currentCell += '"'; i++; } 
                    else { insideQuotes = !insideQuotes; }
                } else if (char === ',' && !insideQuotes) {
                    currentRow.push(currentCell.trim()); currentCell = '';
                } else if (char === '\n' && !insideQuotes) {
                    currentRow.push(currentCell.trim());
                    if (currentRow.some(c => c)) rows.push(currentRow);
                    currentRow = []; currentCell = '';
                } else { currentCell += char; }
            }
            if (currentCell || currentRow.length > 0) {
                currentRow.push(currentCell.trim());
                if (currentRow.some(c => c)) rows.push(currentRow);
            }
            return rows;
        };

        const parseOutline = (outlineText) => {
            if (!outlineText) return [];
            const lines = outlineText.split('\n');
            const sections = [];
            let currentSection = null;
            const getDisplayTitle = (rawTitle) => {
                const t = rawTitle.trim();
                if (t === 'Ëµ∑' || t === 'ÈñãÂ†¥') return 'Ëµ∑';
                if (t === 'Êâø' || t === 'Ë™™Êòé') return 'Êâø';
                if (t === 'ËΩâ' || t === 'Ëß£Ê±∫') return 'ËΩâ';
                if (t === 'Âêà' || t === 'CTA') return 'Âêà';
                return t; 
            };
            lines.forEach(line => {
                const normalizedLine = line.replace(/ÔΩú/g, '|');
                const trimmedLine = normalizedLine.trim();
                if (!trimmedLine) return;
                const pipeIndex = trimmedLine.indexOf('|');
                if (pipeIndex !== -1 && pipeIndex < 10) { 
                    const rawTitle = trimmedLine.substring(0, pipeIndex).trim();
                    const content = trimmedLine.substring(pipeIndex + 1).trim();
                    if (currentSection) sections.push(currentSection);
                    currentSection = { title: getDisplayTitle(rawTitle), content: content };
                } else {
                    if (currentSection) currentSection.content += '\n' + trimmedLine;
                    else currentSection = { title: 'ÂÖßÂÆπ', content: trimmedLine };
                }
            });
            if (currentSection) sections.push(currentSection);
            if (sections.length === 0 && outlineText.trim()) sections.push({ title: "ÂÖßÂÆπ", content: outlineText });
            return sections;
        };

        const parseImportText = (text) => {
            const result = { title: "", core: "", outline: text };
            if (!text) return result;
            const lines = text.split('\n');
            let outlineBuffer = [];
            lines.forEach(line => {
                let cleanLine = line.trim().replace(/ÔΩú/g, '|');
                const lowerLine = cleanLine.toLowerCase();
                if (lowerLine.startsWith('Ê®ôÈ°å') || lowerLine.startsWith('title')) {
                    if (!result.title) result.title = cleanLine.replace(/^(Ê®ôÈ°å|Title)[:Ôºö\s]*/i, '').trim();
                    return; 
                }
                if (lowerLine.startsWith('Ê†∏ÂøÉ') || lowerLine.startsWith('core') || lowerLine.startsWith('Ê¶ÇÂøµ') || lowerLine.startsWith('Á∞°Ëø∞')) {
                    if (!result.core) result.core = cleanLine.replace(/^(Ê†∏ÂøÉ|Core|Ê¶ÇÂøµ|Á∞°Ëø∞)[:Ôºö\s]*/i, '').trim();
                    return; 
                }
                const sectionMatch = cleanLine.match(/^([^\sÔºö:]{1,6})[:Ôºö\s]/); 
                if (sectionMatch) {
                    const rawHeader = sectionMatch[1];
                    if (['Ëµ∑','Êâø','ËΩâ','Âêà','ÈñãÂ†¥','Ë™™Êòé','ÂÑ™Èªû','ÁóõÈªû','Ëß£Ê±∫','CTA','ÁµêÂ∞æ'].includes(rawHeader) || cleanLine.includes('|')) {
                        if (cleanLine.includes('|')) outlineBuffer.push(cleanLine);
                        else {
                            const content = cleanLine.replace(/^([^\sÔºö:]{1,6})[:Ôºö\s]*/, '').trim();
                            let key = rawHeader;
                            if (key === 'ÈñãÂ†¥') key = 'Ëµ∑';
                            else if (key === 'Ë™™Êòé' || key === 'ÂÑ™Èªû') key = 'Êâø';
                            else if (key === 'Ëß£Ê±∫' || key === 'ËΩâÊäò') key = 'ËΩâ';
                            else if (key === 'ÁµêÂ∞æ' || key === 'CTA') key = 'Âêà';
                            outlineBuffer.push(`${key} | ${content}`);
                        }
                        return;
                    }
                }
                if (cleanLine) outlineBuffer.push(cleanLine);
            });
            if (outlineBuffer.length > 0) result.outline = outlineBuffer.join('\n');
            if (!result.title && lines.length > 0) {
                const firstLine = lines[0].trim().replace(/ÔΩú/g, '|');
                if (firstLine.length < 30 && !firstLine.includes('|')) result.title = firstLine;
            }
            return result;
        };

        const exportToCSV = (data) => {
            const headers = ["ÂÆ¢Êà∂ÂêçÁ®±", "‰∏ªÈ°åÂêçÁ®±", "Ê†∏ÂøÉ", "È¢®Ê†º", "Áî¢ÂìÅ/ÊäÄË°ì", "ÈÅ©ÂêàÂÆ¢Áæ§", "Â§ßÁ∂±", "ÂèÉËÄÉÈÄ£Áµê"];
            const rows = data.map(item => [
                `"${item.client?.replace(/"/g, '""') || ''}"`,
                `"${item.title?.replace(/"/g, '""') || ''}"`,
                `"${item.core?.replace(/"/g, '""') || ''}"`,
                `"${item.style?.replace(/"/g, '""') || ''}"`,
                `"${item.product?.replace(/"/g, '""') || ''}"`,
                `"${item.target?.replace(/"/g, '""') || ''}"`,
                `"${item.outline?.replace(/"/g, '""') || ''}"`,
                `"${item.refLink?.replace(/"/g, '""') || ''}"`
            ]);
            const csvContent = "data:text/csv;charset=utf-8,\uFEFF" + headers.join(",") + "\n" + rows.map(e => e.join(",")).join("\n");
            const encodedUri = encodeURI(csvContent);
            const link = document.createElement("a");
            link.setAttribute("href", encodedUri);
            link.setAttribute("download", `ÂÆ¢Êà∂ËÖ≥Êú¨ÂÇô‰ªΩ_${new Date().toLocaleDateString()}.csv`);
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        };

        function App() {
            const [user, setUser] = useState(null);
            const [projects, setProjects] = useState([]);
            const [loading, setLoading] = useState(true);
            // ‚ö†Ô∏è Êñ∞Â¢ûÔºöÈåØË™§Ë®äÊÅØÁãÄÊÖãÔºåÁî®‰æÜÈ°ØÁ§∫ÁÇ∫‰ªÄÈ∫ºÊúÉËΩâÂúàÂúà
            const [errorMsg, setErrorMsg] = useState(null); 
            
            const [activeTab, setActiveTab] = useState('list');
            const [selectedProject, setSelectedProject] = useState(null);
            const [parsedScript, setParsedScript] = useState([]);
            
            // UI State
            const [searchTerm, setSearchTerm] = useState('');
            const [filterClient, setFilterClient] = useState('All');
            const [filterStyle, setFilterStyle] = useState('All');
            const [filterProduct, setFilterProduct] = useState('All');
            const [filterTarget, setFilterTarget] = useState('All');

            const [editingId, setEditingId] = useState(null);
            const [tempData, setTempData] = useState({});
            const [isSettingsOpen, setIsSettingsOpen] = useState(false);
            const [options, setOptions] = useState(DEFAULT_OPTIONS);
            const [newOptionInputs, setNewOptionInputs] = useState({ styles: '', products: '', targets: '' });

            const [isImportOpen, setIsImportOpen] = useState(false);
            const [importText, setImportText] = useState('');
            const [parsedImportData, setParsedImportData] = useState(null);
            const [deleteConfirmId, setDeleteConfirmId] = useState(null);
            
            const fileInputRef = useRef(null);
            const [isUploading, setIsUploading] = useState(false);
            const [uploadProgress, setUploadProgress] = useState({ current: 0, total: 0 });

            // Auth
            useEffect(() => {
                // ÂòóË©¶ÁôªÂÖ•ÔºåÂ¶ÇÊûúÂ§±ÊïóÊúÉÈ°ØÁ§∫ÈåØË™§
                signInAnonymously(auth).catch((error) => {
                    console.error("Auth Error:", error);
                    setErrorMsg("ÁôªÂÖ•Â§±Êïó: " + error.message);
                    setLoading(false);
                });
                
                return onAuthStateChanged(auth, (u) => {
                    setUser(u);
                    // Â¶ÇÊûúÊ≤íÊúâ‰ΩøÁî®ËÄÖÔºå‰πü‰∏çË¶Å‰∏ÄÁõ¥ËΩâÔºåÈ°ØÁ§∫ÈúÄÁôªÂÖ•ÁãÄÊÖã
                    if (!u) {
                        // Normally waiting for auth, but if it takes too long or fails silently
                    }
                });
            }, []);

            // Data Fetching
            useEffect(() => {
                if (!user) return; 
                
                const scriptsRef = collection(db, 'artifacts', appId, 'public', 'data', 'scripts');
                
                // ‚ö†Ô∏è ÈáçË¶Å‰øÆÊ≠£ÔºöÊñ∞Â¢û Error Callback ‰æÜÊçïÊçâÊ¨äÈôêÈåØË™§
                const unsubscribeScripts = onSnapshot(scriptsRef, (snapshot) => {
                    const docs = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
                    docs.sort((a, b) => {
                        if (a.client !== b.client) return (a.client || "").localeCompare(b.client || "");
                        return (b.createdAt?.seconds || 0) - (a.createdAt?.seconds || 0);
                    });
                    setProjects(docs);
                    setLoading(false); // ÊàêÂäüËºâÂÖ•ÔºåÂÅúÊ≠¢ËΩâÂúà
                    
                    if (selectedProject) {
                        const updatedSelected = docs.find(d => d.id === selectedProject.id);
                        if (updatedSelected && JSON.stringify(updatedSelected) !== JSON.stringify(selectedProject)) {
                            setSelectedProject(updatedSelected);
                            setParsedScript(parseOutline(updatedSelected.outline));
                        }
                    }
                }, (error) => {
                    // ‚ö†Ô∏è ÈÄôË£°Â∞±ÊòØÊçïÊçâÈåØË™§ÁöÑÂú∞ÊñπÔºÅ
                    console.error("Firestore Error:", error);
                    let msg = error.message;
                    if (msg.includes("permission-denied")) {
                        msg = "Ê¨äÈôê‰∏çË∂≥ (Permission Denied)„ÄÇË´ãÊ™¢Êü• Firestore Rules„ÄÇ";
                    } else if (msg.includes("quota-exceeded")) {
                        msg = "ÈÖçÈ°çÂ∑≤Êªø (Quota Exceeded)„ÄÇ";
                    } else if (msg.includes("client-offline")) {
                        msg = "Á∂≤Ë∑ØÈÄ£Á∑ö‰∏≠Êñ∑„ÄÇ";
                    }
                    setErrorMsg("ËÆÄÂèñË≥áÊñôÂ§±Êïó: " + msg);
                    setLoading(false); // ÁôºÁîüÈåØË™§‰πüË¶ÅÂÅúÊ≠¢ËΩâÂúàÔºå‰∏çÁÑ∂ÊúÉÂç°Ê≠ª
                });
                
                const optionsRef = doc(db, 'artifacts', appId, 'public', 'data', 'settings', 'global_options');
                const unsubscribeOptions = onSnapshot(optionsRef, (docSnap) => {
                    if (docSnap.exists()) setOptions(docSnap.data());
                    else setDoc(optionsRef, DEFAULT_OPTIONS).catch(console.error);
                }, (error) => {
                    console.error("Options Fetch Error:", error);
                    // ÈÅ∏È†ÖËÆÄÂèñÂ§±ÊïóÈÄöÂ∏∏‰∏çÂΩ±Èüø‰∏ªÂäüËÉΩÔºå‰∏çÈ°ØÁ§∫ÈòªÊìãÊÄßÈåØË™§
                });

                return () => { unsubscribeScripts(); unsubscribeOptions(); };
            }, [user, selectedProject?.id]); 

            // ... (Rest of handlers remain same) ...
            const handleCSVUpload = async (e) => {
                const file = e.target.files?.[0];
                if (!file) return;
                setIsUploading(true);
                setUploadProgress({ current: 0, total: 0 });
                const reader = new FileReader();
                reader.onload = async (event) => {
                    try {
                        const text = event.target.result;
                        const rows = parseCSVFile(text);
                        if (rows.length < 2) { alert("CSV Ê†ºÂºèÈåØË™§"); setIsUploading(false); return; }
                        const header = rows[0].map(h => h.toLowerCase().trim());
                        const getIdx = (keywords) => header.findIndex(h => keywords.some(k => h.includes(k)));
                        const map = { client: getIdx(['ÂÆ¢Êà∂', 'client']), title: getIdx(['‰∏ªÈ°å', 'Ê®ôÈ°å', 'title']), core: getIdx(['Ê†∏ÂøÉ', 'core', 'Ê¶ÇÂøµ']), style: getIdx(['È¢®Ê†º', 'style']), product: getIdx(['Áî¢ÂìÅ', 'product']), target: getIdx(['ÂÆ¢Áæ§', 'target']), outline: getIdx(['Â§ßÁ∂±', 'ÂÖßÂÆπ', 'outline', 'script']), refLink: getIdx(['ÈÄ£Áµê', 'link', 'ÂèÉËÄÉ']) };
                        const dataRows = rows.slice(1);
                        setUploadProgress({ current: 0, total: dataRows.length });
                        let successCount = 0;
                        for (const row of dataRows) {
                            if (!row[map.outline] && !row[map.title]) continue;
                            const newDoc = { client: map.client > -1 ? row[map.client] : (row[0] || "ÂåØÂÖ•ÂÆ¢Êà∂"), title: map.title > -1 ? row[map.title] : (row[1] || "Êú™ÂëΩÂêç"), core: map.core > -1 ? row[map.core] : "", style: map.style > -1 ? row[map.style] : "", product: map.product > -1 ? row[map.product] : "", target: map.target > -1 ? row[map.target] : "", outline: map.outline > -1 ? row[map.outline] : (row[6] || ""), refLink: map.refLink > -1 ? row[map.refLink] : "", createdAt: serverTimestamp() };
                            await addDoc(collection(db, 'artifacts', appId, 'public', 'data', 'scripts'), newDoc);
                            successCount++;
                            setUploadProgress(prev => ({ ...prev, current: successCount }));
                        }
                        alert(`ÂåØÂÖ•ÂÆåÊàêÔºö${successCount} Á≠Ü`);
                    } catch (err) { console.error(err); alert("ÂåØÂÖ•ÈåØË™§"); } finally { setIsUploading(false); if (fileInputRef.current) fileInputRef.current.value = ''; }
                };
                reader.readAsText(file);
            };

            const handleAddOption = async (category, value) => {
                if (!value.trim()) return;
                const currentList = options[category] || [];
                if (currentList.includes(value)) return;
                const newOptions = { ...options, [category]: [...currentList, value.trim()] };
                setOptions(newOptions);
                setNewOptionInputs({ ...newOptionInputs, [category]: '' });
                await setDoc(doc(db, 'artifacts', appId, 'public', 'data', 'settings', 'global_options'), newOptions, { merge: true });
            };
            const handleRemoveOption = async (category, value) => {
                if (!window.confirm(`Âà™Èô§„Äå${value}„ÄçÔºü`)) return;
                const newOptions = { ...options, [category]: (options[category] || []).filter(i => i !== value) };
                setOptions(newOptions);
                await setDoc(doc(db, 'artifacts', appId, 'public', 'data', 'settings', 'global_options'), newOptions, { merge: true });
            };
            const handleAnalyzeImport = () => setParsedImportData(parseImportText(importText));
            const handleConfirmImport = async () => {
                if (!parsedImportData) return;
                try {
                    const newProjectData = { client: "ÂåØÂÖ•ËÖ≥Êú¨", title: parsedImportData.title || "Êú™ÂëΩÂêç", core: parsedImportData.core || "AI ÁîüÊàê", style: "", product: "", target: "", refLink: "", outline: parsedImportData.outline || importText, createdAt: serverTimestamp() };
                    const docRef = await addDoc(collection(db, 'artifacts', appId, 'public', 'data', 'scripts'), newProjectData);
                    handleSelectProject({ id: docRef.id, ...newProjectData, createdAt: { seconds: Date.now() / 1000 } });
                    setImportText(''); setParsedImportData(null); setIsImportOpen(false);
                } catch (e) { console.error(e); alert("ÂåØÂÖ•Â§±Êïó"); }
            };
            const handleAddProject = async () => {
                await addDoc(collection(db, 'artifacts', appId, 'public', 'data', 'scripts'), { client: "Êñ∞ÂÆ¢Êà∂", title: "Êú™ÂëΩÂêçÂ∞àÊ°à", core: "", style: options.styles?.[0]||"", product: options.products?.[0]||"", target: options.targets?.[0]||"", refLink: "", outline: "Ëµ∑ | \nÊâø | \nËΩâ | \nÂêà | ", createdAt: serverTimestamp() });
            };
            const handleDuplicate = async (e, p) => { e.stopPropagation(); const {id, ...d} = p; await addDoc(collection(db, 'artifacts', appId, 'public', 'data', 'scripts'), {...d, title: `${d.title} (ÂâØÊú¨)`, createdAt: serverTimestamp()}); };
            const requestDelete = (e, id) => { e.stopPropagation(); setDeleteConfirmId(id); };
            const executeDelete = async () => { if (!deleteConfirmId) return; await deleteDoc(doc(db, 'artifacts', appId, 'public', 'data', 'scripts', deleteConfirmId)); if (selectedProject?.id === deleteConfirmId) { setSelectedProject(null); setActiveTab('list'); } setDeleteConfirmId(null); };
            const handleUpdate = async (id, d) => { await updateDoc(doc(db, 'artifacts', appId, 'public', 'data', 'scripts', id), {...d, lastEditedAt: serverTimestamp()}); setEditingId(null); };
            const handleSelectProject = (p) => { if(editingId !== p.id) { setSelectedProject(p); setParsedScript(parseOutline(p.outline)); setActiveTab('preview'); }};
            const saveInlineEdit = () => { if(editingId && tempData) handleUpdate(editingId, tempData); };

            const uniqueClients = useMemo(() => ['All', ...Array.from(new Set(projects.map(p => p.client || 'Êú™ÂàÜÈ°û').filter(Boolean))).sort()], [projects]);
            const filteredProjects = useMemo(() => projects.filter(p => {
                const s = searchTerm.toLowerCase();
                const matchSearch = (p.title||'').toLowerCase().includes(s) || (p.client||'').toLowerCase().includes(s) || (p.core||'').toLowerCase().includes(s);
                return matchSearch && (filterClient === 'All' || (p.client||'Êú™ÂàÜÈ°û') === filterClient) && (filterStyle === 'All' || (p.style||'') === filterStyle) && (filterProduct === 'All' || (p.product||'') === filterProduct) && (filterTarget === 'All' || (p.target||'') === filterTarget);
            }), [projects, searchTerm, filterClient, filterStyle, filterProduct, filterTarget]);
            const clearFilters = () => { setSearchTerm(''); setFilterClient('All'); setFilterStyle('All'); setFilterProduct('All'); setFilterTarget('All'); };
            const hasActiveFilters = searchTerm || filterClient !== 'All' || filterStyle !== 'All' || filterProduct !== 'All' || filterTarget !== 'All';

            // ‚ö†Ô∏è ÈåØË™§ËôïÁêÜ‰ªãÈù¢ÔºöÂ¶ÇÊûúÊúâÈåØË™§ÔºåÈ°ØÁ§∫ÈåØË™§Ë®äÊÅØÔºåËÄå‰∏çÊòØ‰∏ÄÁõ¥ËΩâÂúà
            if (errorMsg) {
                return React.createElement('div', {className: "flex h-screen items-center justify-center text-red-500 flex-col gap-4 p-8 text-center"},
                    React.createElement(AlertTriangle, {className: "w-16 h-16"}),
                    React.createElement('h2', {className: "text-2xl font-bold"}, "ÈÄ£Á∑öÁôºÁîüÈåØË™§"),
                    React.createElement('p', {className: "text-lg"}, errorMsg),
                    React.createElement('div', {className: "bg-red-50 p-4 rounded text-sm text-left max-w-lg"},
                        React.createElement('p', {className: "font-bold mb-2"}, "Â∏∏Ë¶ãËß£Ê±∫ÊñπÊ≥ïÔºö"),
                        React.createElement('ul', {className: "list-disc pl-5 space-y-1"},
                            React.createElement('li', null, "Ë´ãÂâçÂæÄ Firebase Console > Authentication > Settings > Authorized domains"),
                            React.createElement('li', null, "Êñ∞Â¢ûÊÇ®ÁöÑ GitHub Á∂≤ÂùÄ (‰æãÂ¶Ç yourname.github.io)"),
                            React.createElement('li', null, "Á¢∫Ë™ç Firestore Database ÊòØÂê¶Â∑≤Âª∫Á´ã‰∏¶Ë®≠ÁÇ∫ÂÖ¨Èñã (Rules)")
                        )
                    ),
                    React.createElement('button', {onClick: () => window.location.reload(), className: "mt-4 px-6 py-2 bg-slate-800 text-white rounded hover:bg-slate-700"}, "ÈáçÊñ∞Êï¥ÁêÜ")
                );
            }

            if (loading) return React.createElement('div', {className: "flex h-screen items-center justify-center text-slate-500 gap-2"}, React.createElement(Loader2, {className: "w-8 h-8 animate-spin text-teal-600"}), " ËºâÂÖ•‰∏≠...");

            // --- Render ---
            return React.createElement('div', { className: "min-h-screen bg-slate-50 text-gray-800 font-sans" },
                React.createElement('nav', { className: "bg-teal-900 text-white p-3 shadow-lg flex justify-between items-center sticky top-0 z-20 no-print" },
                    React.createElement('div', { className: "flex items-center gap-3" },
                        React.createElement('div', { className: "bg-teal-600 p-2 rounded-lg shadow-inner" }, React.createElement(Briefcase, { className: "w-5 h-5 text-white" })),
                        React.createElement('div', null, React.createElement('h1', { className: "text-lg font-bold" }, "Client Script Manager"), React.createElement('p', { className: "text-[10px] text-teal-300" }, "ÂÆ¢Êà∂Â∞àÊ°àÁÆ°ÁêÜÁ≥ªÁµ±"))
                    ),
                    React.createElement('div', { className: "flex items-center gap-2" },
                        activeTab === 'list' && React.createElement(React.Fragment, null,
                            React.createElement('input', { type: "file", accept: ".csv", ref: fileInputRef, className: "hidden", onChange: handleCSVUpload }),
                            React.createElement('button', { onClick: () => fileInputRef.current?.click(), className: "text-teal-100 hover:text-white hover:bg-teal-800 px-3 py-1.5 rounded flex items-center gap-1 transition-colors text-xs font-medium border border-teal-700/50" }, React.createElement(FileSpreadsheet, { className: "w-4 h-4" }), " ÂåØÂÖ•"),
                            React.createElement('button', { onClick: () => exportToCSV(projects), className: "text-teal-100 hover:text-white hover:bg-teal-800 px-3 py-1.5 rounded flex items-center gap-1 transition-colors text-xs font-medium border border-teal-700/50" }, React.createElement(Download, { className: "w-4 h-4" }), " ÂåØÂá∫"),
                            React.createElement('button', { onClick: () => setIsSettingsOpen(true), className: "text-teal-200 hover:text-white p-2 rounded-full hover:bg-teal-800" }, React.createElement(Settings, { className: "w-5 h-5" }))
                        )
                    )
                ),
                React.createElement('main', { className: "container mx-auto p-4 md:p-6 max-w-[1400px]" },
                    deleteConfirmId && React.createElement('div', { className: "fixed inset-0 bg-black/60 z-[70] flex items-center justify-center p-4 backdrop-blur-sm animate-fadeIn" },
                        React.createElement('div', { className: "bg-white rounded-xl shadow-2xl w-full max-w-sm overflow-hidden flex flex-col" },
                            React.createElement('div', { className: "p-6 text-center" },
                                React.createElement('div', { className: "w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4" }, React.createElement(Trash2, { className: "w-8 h-8 text-red-500" })),
                                React.createElement('h3', { className: "text-xl font-bold text-slate-800 mb-2" }, "Á¢∫ÂÆöË¶ÅÂà™Èô§ÂóéÔºü"),
                                React.createElement('p', { className: "text-slate-500 text-sm" }, "Ê≠§Êìç‰ΩúÁÑ°Ê≥ïÂæ©ÂéüÔºåË©≤ËÖ≥Êú¨Â∞áÊúÉÊ∞∏‰πÖÁßªÈô§„ÄÇ")
                            ),
                            React.createElement('div', { className: "p-4 bg-gray-50 flex gap-3 justify-center border-t border-gray-100" },
                                React.createElement('button', { onClick: () => setDeleteConfirmId(null), className: "px-5 py-2 bg-white border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 font-medium transition-colors" }, "ÂèñÊ∂à"),
                                React.createElement('button', { onClick: executeDelete, className: "px-5 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 font-medium shadow-md transition-colors flex items-center gap-2" }, React.createElement(Trash2, { className: "w-4 h-4" }), " Á¢∫Ë™çÂà™Èô§")
                            )
                        )
                    ),
                    isSettingsOpen && React.createElement('div', { className: "fixed inset-0 bg-black/60 z-50 flex items-center justify-center p-4 backdrop-blur-sm" },
                        React.createElement('div', { className: "bg-white rounded-xl shadow-2xl w-full max-w-3xl overflow-hidden flex flex-col max-h-[85vh]" },
                            React.createElement('div', { className: "p-4 border-b flex justify-between" }, React.createElement('h3', { className: "font-bold text-lg" }, "Ë®≠ÂÆö"), React.createElement('button', { onClick: () => setIsSettingsOpen(false) }, React.createElement(X, { className: "w-5 h-5" }))),
                            React.createElement('div', { className: "p-6 overflow-y-auto grid grid-cols-3 gap-4 bg-slate-50" },
                                ['styles', 'products', 'targets'].map(type => React.createElement('div', { key: type, className: "bg-white p-3 rounded shadow border" },
                                    React.createElement('h4', { className: "font-bold mb-2 capitalize" }, type),
                                    React.createElement('ul', { className: "max-h-40 overflow-y-auto mb-2 text-sm" }, options[type]?.map(o => React.createElement('li', { key: o, className: "flex justify-between p-1 hover:bg-gray-100" }, o, React.createElement('button', { onClick: () => handleRemoveOption(type, o), className: "text-red-300 hover:text-red-500" }, React.createElement(MinusCircle, { className: "w-3 h-3" }))))),
                                    React.createElement('div', { className: "flex gap-1" }, React.createElement('input', { className: "border rounded w-full px-1 text-sm", value: newOptionInputs[type], onChange: e => setNewOptionInputs({ ...newOptionInputs, [type]: e.target.value }) }), React.createElement('button', { onClick: () => handleAddOption(type, newOptionInputs[type]), className: "text-teal-600" }, React.createElement(PlusCircle, null)))
                                ))
                            )
                        )
                    ),
                    isImportOpen && React.createElement('div', { className: "fixed inset-0 bg-black/60 z-50 flex items-center justify-center p-4 backdrop-blur-sm" },
                        React.createElement('div', { className: "bg-white rounded-xl shadow-2xl w-full max-w-2xl overflow-hidden flex flex-col max-h-[90vh]" },
                            React.createElement('div', { className: "p-4 border-b bg-indigo-50 flex justify-between" }, React.createElement('h3', { className: "font-bold text-lg text-indigo-900" }, "ÂñÆÁ≠ÜÊñáÂ≠óÂåØÂÖ•"), React.createElement('button', { onClick: () => setIsImportOpen(false) }, React.createElement(X, { className: "w-5 h-5" }))),
                            React.createElement('div', { className: "p-6 overflow-y-auto space-y-4" },
                                !parsedImportData ? React.createElement('textarea', { className: "w-full h-64 border rounded p-3 text-sm font-mono", placeholder: "Ë≤º‰∏äËÖ≥Êú¨ÊñáÂ≠ó...", value: importText, onChange: e => setImportText(e.target.value) }) :
                                React.createElement('div', { className: "space-y-2" },
                                    React.createElement('p', { className: "text-green-600 font-bold flex gap-2" }, React.createElement(Check, null), " Ëß£ÊûêÊàêÂäü"),
                                    React.createElement('input', { className: "w-full border rounded p-2", value: parsedImportData.title, onChange: e => setParsedImportData({ ...parsedImportData, title: e.target.value }) }),
                                    React.createElement('input', { className: "w-full border rounded p-2", value: parsedImportData.core, onChange: e => setParsedImportData({ ...parsedImportData, core: e.target.value }) }),
                                    React.createElement('textarea', { className: "w-full h-40 border rounded p-2 font-mono text-sm", value: parsedImportData.outline, onChange: e => setParsedImportData({ ...parsedImportData, outline: e.target.value }) })
                                )
                            ),
                            React.createElement('div', { className: "p-4 border-t flex justify-end gap-2" },
                                !parsedImportData ? React.createElement('button', { onClick: handleAnalyzeImport, disabled: !importText.trim(), className: "bg-indigo-600 text-white px-4 py-2 rounded" }, "Ëß£Êûê") : React.createElement('button', { onClick: handleConfirmImport, className: "bg-green-600 text-white px-4 py-2 rounded" }, "Á¢∫Ë™çÂåØÂÖ•")
                            )
                        )
                    ),
                    isUploading && React.createElement('div', { className: "fixed inset-0 bg-black/80 z-[60] flex flex-col items-center justify-center text-white" },
                        React.createElement(Loader2, { className: "w-12 h-12 animate-spin mb-4 text-teal-400" }),
                        React.createElement('h3', { className: "text-xl font-bold" }, "Ê≠£Âú®ÂåØÂÖ• CSV..."),
                        React.createElement('p', { className: "mt-2 text-teal-200" }, `ÈÄ≤Â∫¶Ôºö${uploadProgress.current} / ${uploadProgress.total}`)
                    ),
                    React.createElement('div', { className: "flex flex-col xl:flex-row xl:items-center justify-between gap-4 mb-6 no-print" },
                        React.createElement('div', { className: "flex bg-white p-1 rounded-lg shadow-sm border border-gray-200 w-fit" },
                            React.createElement('button', { onClick: () => setActiveTab('list'), className: `flex items-center gap-2 px-6 py-2 rounded-md text-sm font-bold transition-all ${activeTab === 'list' ? 'bg-teal-50 text-teal-900 shadow-sm' : 'text-gray-500'}` }, React.createElement(Database, { className: "w-4 h-4" }), " Â∞àÊ°àÁ∏ΩË¶Ω"),
                            React.createElement('button', { disabled: !selectedProject, onClick: () => setActiveTab('preview'), className: `flex items-center gap-2 px-6 py-2 rounded-md text-sm font-bold transition-all ${activeTab === 'preview' ? 'bg-teal-600 text-white shadow-sm' : 'text-gray-400'}` }, React.createElement(FileText, { className: "w-4 h-4" }), " ËÖ≥Êú¨È†êË¶Ω")
                        ),
                        activeTab === 'list' && React.createElement('div', { className: "flex flex-col md:flex-row flex-1 gap-2 max-w-4xl" },
                            React.createElement('div', { className: "flex flex-1 items-center bg-white p-1.5 rounded-lg border border-gray-200 shadow-sm" },
                                React.createElement(Search, { className: "w-4 h-4 text-gray-400 ml-2 mr-2" }),
                                React.createElement('input', { type: "text", placeholder: "ÊêúÂ∞ãÈóúÈçµÂ≠ó...", className: "flex-1 bg-transparent border-none text-sm focus:ring-0 outline-none", value: searchTerm, onChange: e => setSearchTerm(e.target.value) })
                            ),
                            React.createElement('div', { className: "flex gap-2 overflow-x-auto pb-1 md:pb-0" },
                                React.createElement('select', { className: "bg-white text-sm border border-gray-200 rounded py-1.5 px-3 text-gray-700 focus:ring-2 focus:ring-teal-500 outline-none shadow-sm cursor-pointer min-w-[100px]", value: filterClient, onChange: e => setFilterClient(e.target.value) }, React.createElement('option', { value: "All" }, "ÊâÄÊúâÂÆ¢Êà∂"), uniqueClients.filter(c => c !== 'All').map(c => React.createElement('option', { key: c }, c))),
                                React.createElement('select', { className: "bg-white text-sm border border-gray-200 rounded py-1.5 px-3 text-gray-700 focus:ring-2 focus:ring-teal-500 outline-none shadow-sm cursor-pointer min-w-[100px]", value: filterStyle, onChange: e => setFilterStyle(e.target.value) }, React.createElement('option', { value: "All" }, "ÊâÄÊúâÈ¢®Ê†º"), options.styles?.map(s => React.createElement('option', { key: s }, s))),
                                React.createElement('select', { className: "bg-white text-sm border border-gray-200 rounded py-1.5 px-3 text-gray-700 focus:ring-2 focus:ring-teal-500 outline-none shadow-sm cursor-pointer min-w-[100px]", value: filterProduct, onChange: e => setFilterProduct(e.target.value) }, React.createElement('option', { value: "All" }, "ÊâÄÊúâÁî¢ÂìÅ"), options.products?.map(p => React.createElement('option', { key: p }, p))),
                                React.createElement('select', { className: "bg-white text-sm border border-gray-200 rounded py-1.5 px-3 text-gray-700 focus:ring-2 focus:ring-teal-500 outline-none shadow-sm cursor-pointer min-w-[100px]", value: filterTarget, onChange: e => setFilterTarget(e.target.value) }, React.createElement('option', { value: "All" }, "ÊâÄÊúâÂÆ¢Áæ§"), options.targets?.map(t => React.createElement('option', { key: t }, t))),
                                hasActiveFilters && React.createElement('button', { onClick: clearFilters, className: "px-3 py-1.5 text-red-500 bg-red-50 hover:bg-red-100 rounded text-xs whitespace-nowrap flex items-center gap-1" }, React.createElement(X, { className: "w-3 h-3" }), " ÈáçÁΩÆ")
                            )
                        ),
                        activeTab === 'list' && React.createElement('div', { className: "flex gap-2" },
                            React.createElement('button', { onClick: () => setIsImportOpen(true), className: "bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-lg shadow-md flex items-center gap-2 text-sm font-bold whitespace-nowrap" }, React.createElement(Upload, { className: "w-4 h-4" }), " ÂñÆÁ≠Ü"),
                            React.createElement('button', { onClick: handleAddProject, className: "bg-teal-600 hover:bg-teal-700 text-white px-4 py-2 rounded-lg shadow-md flex items-center gap-2 text-sm font-bold whitespace-nowrap" }, React.createElement(Plus, { className: "w-4 h-4" }), " Êñ∞Â¢û")
                        )
                    ),
                    activeTab === 'list' && React.createElement('div', { className: "bg-white rounded-xl shadow-md border border-gray-200 overflow-hidden flex flex-col h-[calc(100vh-240px)]" },
                        React.createElement('div', { className: "overflow-auto flex-1" },
                            React.createElement('table', { className: "w-full text-left border-collapse min-w-[1400px]" },
                                React.createElement('thead', { className: "sticky top-0 z-10 bg-gray-100 shadow-sm text-gray-500 text-xs font-bold uppercase whitespace-nowrap" },
                                    React.createElement('tr', null,
                                        React.createElement('th', { className: "p-3 pl-6 w-32" }, "ÂÆ¢Êà∂"),
                                        React.createElement('th', { className: "p-3 w-40" }, "‰∏ªÈ°å"),
                                        React.createElement('th', { className: "p-3 w-48" }, "Ê†∏ÂøÉ"),
                                        React.createElement('th', { className: "p-3 w-32" }, "Ê®ôÁ±§ (È¢®Ê†º/Áî¢ÂìÅ/ÂÆ¢Áæ§)"),
                                        React.createElement('th', { className: "p-3 min-w-[300px]" }, "Â§ßÁ∂±"),
                                        React.createElement('th', { className: "p-3 w-24" }, "ÈÄ£Áµê"),
                                        React.createElement('th', { className: "p-3 w-28 text-center sticky right-0 bg-gray-100" }, "Êìç‰Ωú")
                                    )
                                ),
                                React.createElement('tbody', { className: "text-sm text-gray-600 divide-y divide-gray-100" },
                                    filteredProjects.map(p => {
                                        const isEditing = editingId === p.id;
                                        return React.createElement('tr', { key: p.id, className: `group border-l-4 hover:bg-gray-50 ${isEditing ? 'bg-teal-50 border-teal-500' : 'border-transparent'}`, onClick: () => !isEditing && handleSelectProject(p) },
                                            React.createElement('td', { className: "p-3 pl-6 align-top font-bold text-teal-800" }, isEditing ? React.createElement('input', { className: "w-full border rounded p-1", value: tempData.client, onChange: e => setTempData({ ...tempData, client: e.target.value }) }) : p.client),
                                            React.createElement('td', { className: "p-3 align-top font-bold" }, isEditing ? React.createElement('input', { className: "w-full border rounded p-1", value: tempData.title, onChange: e => setTempData({ ...tempData, title: e.target.value }) }) : p.title),
                                            React.createElement('td', { className: "p-3 align-top text-xs" }, isEditing ? React.createElement('textarea', { className: "w-full border rounded p-1", rows: 3, value: tempData.core, onChange: e => setTempData({ ...tempData, core: e.target.value }) }) : p.core),
                                            React.createElement('td', { className: "p-3 align-top space-y-1" },
                                                isEditing ? React.createElement('div', { className: "flex flex-col gap-1" },
                                                    React.createElement('select', { className: "border rounded p-1 text-xs", value: tempData.style, onChange: e => setTempData({ ...tempData, style: e.target.value }) }, React.createElement('option', { value: "" }, "È¢®Ê†º"), options.styles?.map(o => React.createElement('option', { key: o }, o))),
                                                    React.createElement('select', { className: "border rounded p-1 text-xs", value: tempData.product, onChange: e => setTempData({ ...tempData, product: e.target.value }) }, React.createElement('option', { value: "" }, "Áî¢ÂìÅ"), options.products?.map(o => React.createElement('option', { key: o }, o))),
                                                    React.createElement('select', { className: "border rounded p-1 text-xs", value: tempData.target, onChange: e => setTempData({ ...tempData, target: e.target.value }) }, React.createElement('option', { value: "" }, "ÂÆ¢Áæ§"), options.targets?.map(o => React.createElement('option', { key: o }, o)))
                                                ) : React.createElement('div', { className: "flex flex-col gap-1 items-start" },
                                                    p.style && React.createElement('span', { className: "px-2 py-0.5 bg-gray-100 rounded text-[10px] border" }, `üé® ${p.style}`),
                                                    p.product && React.createElement('span', { className: "px-2 py-0.5 bg-blue-50 text-blue-600 rounded text-[10px] border border-blue-100" }, `üì¶ ${p.product}`),
                                                    p.target && React.createElement('span', { className: "px-2 py-0.5 bg-emerald-50 text-emerald-600 rounded text-[10px] border border-emerald-100" }, `üéØ ${p.target}`)
                                                )
                                            ),
                                            React.createElement('td', { className: "p-3 align-top font-mono text-xs truncate max-w-xs", title: p.outline }, isEditing ? React.createElement('textarea', { className: "w-full border rounded p-1 font-mono", rows: 6, value: tempData.outline, onChange: e => setTempData({ ...tempData, outline: e.target.value }) }) : p.outline?.substring(0, 50) + '...'),
                                            React.createElement('td', { className: "p-3 align-top" }, isEditing ? React.createElement('input', { className: "w-full border rounded p-1 text-xs", value: tempData.refLink, onChange: e => setTempData({ ...tempData, refLink: e.target.value }) }) : p.refLink && React.createElement('a', { href: p.refLink, target: "_blank", className: "text-teal-600", onClick: e => e.stopPropagation() }, React.createElement(ExternalLink, { className: "w-4 h-4" }))),
                                            React.createElement('td', { className: "p-3 text-center sticky right-0 bg-white group-hover:bg-gray-50 shadow-[-5px_0_10px_-5px_rgba(0,0,0,0.05)]", onClick: e => e.stopPropagation() },
                                                isEditing ? React.createElement('div', { className: "flex gap-1" }, React.createElement('button', { onClick: saveInlineEdit }, React.createElement(Save, { className: "w-4 h-4 text-teal-600" })), React.createElement('button', { onClick: () => setEditingId(null) }, React.createElement(X, { className: "w-4 h-4 text-gray-400" })))
                                                    : React.createElement('div', { className: "flex gap-2 justify-center opacity-0 group-hover:opacity-100" },
                                                        React.createElement('button', { onClick: (e) => { e.stopPropagation(); setEditingId(p.id); setTempData({ ...p }); } }, React.createElement(AlertCircle, { className: "w-4 h-4 text-teal-600" })),
                                                        React.createElement('button', { onClick: (e) => handleDuplicate(e, p) }, React.createElement(Copy, { className: "w-4 h-4 text-blue-500" })),
                                                        React.createElement('button', { onClick: (e) => requestDelete(e, p.id) }, React.createElement(Trash2, { className: "w-4 h-4 text-red-400" }))
                                                    )
                                            )
                                        );
                                    })
                                )
                            )
                        )
                    ),
                    activeTab === 'preview' && selectedProject && React.createElement('div', { className: "max-w-4xl mx-auto animate-fadeIn pb-20 print-container" },
                        React.createElement('div', { className: "flex justify-between items-center mb-4 no-print" },
                            React.createElement('button', { onClick: () => setActiveTab('list'), className: "text-gray-500 hover:text-gray-800 flex items-center gap-1 text-sm bg-white px-3 py-1.5 rounded-full shadow-sm" }, React.createElement(ArrowRight, { className: "w-4 h-4 rotate-180" }), " ËøîÂõû"),
                            React.createElement('button', { onClick: () => window.print(), className: "flex items-center gap-2 px-4 py-2 bg-teal-900 text-white rounded hover:bg-teal-800 shadow-lg text-sm font-bold" }, React.createElement(Printer, { className: "w-4 h-4" }), " ÂàóÂç∞ / PDF")
                        ),
                        React.createElement('div', { className: "bg-white shadow-2xl border border-gray-200 min-h-[800px] p-0 print:shadow-none print:border-none print:m-0" },
                            React.createElement('div', { className: "flex border-b-2 border-teal-900" },
                                React.createElement('div', { className: "w-32 bg-teal-50 p-4 font-bold text-teal-900 border-r border-teal-100 text-center flex items-center justify-center" }, "Â∞àÊ°à"),
                                React.createElement('div', { className: "p-4 flex-1" },
                                    React.createElement('div', { className: "font-bold text-2xl mb-2" }, selectedProject.title),
                                    React.createElement('div', { className: "text-sm font-bold text-teal-600 bg-teal-50 px-3 py-1 rounded w-fit" }, selectedProject.client),
                                    React.createElement('div', { className: "flex gap-2 mt-2" },
                                        selectedProject.product && React.createElement('span', { className: "px-2 py-0.5 bg-blue-100 text-blue-800 text-xs rounded font-bold" }, `üì¶ ${selectedProject.product}`),
                                        selectedProject.style && React.createElement('span', { className: "px-2 py-0.5 bg-gray-100 text-gray-800 text-xs rounded font-bold" }, `üé® ${selectedProject.style}`)
                                    )
                                )
                            ),
                            React.createElement('div', { className: "flex border-b-2 border-teal-900" },
                                React.createElement('div', { className: "w-32 bg-teal-50 p-4 font-bold text-teal-900 border-r border-teal-100 text-center flex items-center justify-center" }, "Ê†∏ÂøÉ"),
                                React.createElement('div', { className: "p-4 text-slate-600 text-sm flex items-center" }, selectedProject.core)
                            ),
                            React.createElement('div', { className: "w-full" },
                                React.createElement('div', { className: "grid grid-cols-12 bg-teal-800 text-white text-sm font-bold border-b border-teal-900" },
                                    React.createElement('div', { className: "col-span-2 p-3 text-center border-r border-teal-700" }, "ÊÆµËêΩ"),
                                    React.createElement('div', { className: "col-span-4 p-3 text-center border-r border-teal-700" }, "Áï´Èù¢ / ÊÉÖÂ¢É"),
                                    React.createElement('div', { className: "col-span-4 p-3 text-center border-r border-teal-700" }, "Â≠óÂπïÈáçÈªû"),
                                    React.createElement('div', { className: "col-span-2 p-3 text-center" }, "Á§∫ÊÑèÂúñ")
                                ),
                                parsedScript.map((s, i) => React.createElement('div', { key: i, className: "grid grid-cols-12 border-b border-gray-300 min-h-[120px] print:break-inside-avoid" },
                                    React.createElement('div', { className: "col-span-2 p-4 font-bold text-gray-700 flex items-center justify-center text-center border-r border-gray-200 bg-gray-50/50 text-lg" }, s.title),
                                    React.createElement('div', { className: "col-span-4 p-4 text-sm text-gray-600 border-r border-gray-200 whitespace-pre-wrap" }, s.content.split('Ôºö')[0] || s.content),
                                    React.createElement('div', { className: "col-span-4 p-4 text-sm text-gray-800 border-r border-gray-200 whitespace-pre-wrap font-medium bg-teal-50/30" }, s.content.includes('Ôºö') ? s.content.split('Ôºö')[1] : ''),
                                    React.createElement('div', { className: "col-span-2 p-4 flex items-center justify-center" }, React.createElement('div', { className: "h-16 w-full border-2 border-dashed border-gray-200 rounded text-xs text-gray-400 flex items-center justify-center" }, "Âúñ"))
                                )),
                                React.createElement('div', { className: "p-4 text-xs text-gray-400 text-center border-t mt-4" }, "Script generated by Client Script Manager")
                            )
                        )
                    )
                )
            );
        }

        const root = createRoot(document.getElementById('root'));
        root.render(React.createElement(App));
    </script>
</body>
</html>
